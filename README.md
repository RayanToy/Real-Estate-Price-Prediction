# Real-Estate-Price-Prediction
Анализ данных и построение моделей машинного обучения для прогнозирования стоимости квартир. Проект включает в себя исследовательский анализ, предобработку данных с заполнением пропусков с помощью моделей, инжиниринг признаков, а также сравнение и оптимизацию регрессионных моделей, включая CatBoost, LightGBM, XGBoost и PyTorch.

# Анализ рынка недвижимости и прогнозирование стоимости квартир

## О проекте

Этот проект представляет собой исследование данных о рынке недвижимости с целью выявления ключевых факторов, влияющих на стоимость квартир, и построения предиктивной модели машинного обучения. Анализ выполнен на наборе данных, содержащем объявления о продаже квартир в нескольких крупных городах России.

Основная цель работы — разработать модель, способную с высокой точностью прогнозировать цену за квадратный метр на основе характеристик объекта недвижимости.

## Структура проекта

*   `Анализ и прогнозирование цены квадратного метра жилплощади в различных городах.ipynb` — Jupyter Notebook, содержащий весь код для анализа данных, их предобработки, визуализации, построения и оценки моделей.
*   `flats.xlsx - Лист1.csv` — исходный файл с данными (необходимо разместить в корневой директории).
*   `requirements.txt` — список необходимых библиотек для воспроизведения окружения.
*   `README.md` — данный файл с описанием проекта.

## Этапы работы

1.  **Исследовательский анализ данных (EDA)**:
    *   Проведено изучение структуры и распределения данных. Выявлено, что целевая переменная (цена за квадратный метр) имеет бимодальное распределение, обусловленное географическими и временными факторами (разные рынки городов и года постройки).
    *   С помощью визуализаций и статистических тестов (тест Краскела-Уоллиса, корреляция Спирмена) проанализировано влияние различных признаков на цену.

2.  **Предобработка и инжиниринг признаков**:
    *   Выполнена очистка и стандартизация данных, включая приведение текстовых категорий к единому формату.
    *   Для заполнения пропущенных значений в ключевых столбцах (`build_year`, `house_wall_type`, `bathroom_type` и др.) применён подход с обучением моделей `CatBoost`, что позволило сохранить данные без значительных потерь.
    *   Сгенерирован новый признак `cluster` с помощью алгоритма `KMeans`, основанный на географических координатах, времени до метро и годе постройки. Это позволило учесть локальные особенности районов.

3.  **Сравнение и выбор модели**:
    *   Проведено сравнение нескольких регрессионных моделей: `RandomForest`, `CatBoost`, `XGBoost`, `LightGBM`, `Ridge` и нейронной сети на `PyTorch`.
    *   Лучшие результаты показали модели градиентного бустинга.

4.  **Оптимизация и финальная модель**:
    *   Для модели `LightGBM`, показавшей одну из лучших базовых метрик и высокую скорость, был произведен подбор гиперпараметров с использованием `Optuna`.
    *   Оптимизация позволила достичь на отложенной тестовой выборке значения метрики **R² ≈ 0.93**, что свидетельствует о высокой предсказательной силе итоговой модели.

## Как запустить проект

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL-вашего-репозитория>
    cd <название-папки-репозитория>
    ```

2.  **Создайте виртуальное окружение и установите зависимости:**
    *   Убедитесь, что у вас установлен Python 3.x.
    *   Создайте и активируйте виртуальное окружение:
        ```bash
        python -m venv venv
        source venv/bin/activate  # Для Linux/macOS
        venv\Scripts\activate    # Для Windows
        ```
    *   Установите все необходимые библиотеки:
        ```bash
        pip install -r requirements.txt
        ```

3.  **Разместите данные:**
    *   Поместите файл с данными `flats.xlsx - Лист1.csv` в корневую директорию проекта.

4.  **Запустите Jupyter Notebook:**
    ```bash
    jupyter notebook Анализ и прогнозирование цены квадратного метра жилплощади в различных городах.ipynb
    ```

## Результаты

Финальная модель `LightGBM` после оптимизации гиперпараметров показала следующие метрики на тестовом наборе данных:
*   **MAE**: 14402.44
*   **RMSE**: 21697.74
*   **R²**: 0.9317
*   **MAPE**: 7.65%

Наиболее важными признаками для модели оказались:
1.  **Координаты** (`lat`, `lon`) и производный от них **кластер**
2.  **Площадь** (`area`)
3.  **Город** (`city`)
4.  **Год постройки** (`build_year`)
5.  **Время пешком до метро** (`time_on_foot_to_subway`)
